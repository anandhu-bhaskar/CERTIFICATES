if(void 0===COMSCORE)var COMSCORE={};void 0===COMSCORE.SiteRecruit&&(COMSCORE.SiteRecruit={sv:"scor",testUrl:"broker-test.js",configUrl:"broker-config.js",builderUrl:"builder.js",allowScriptCaching:!1,CONSTANTS:{COOKIE_TYPE:{ALREADY_ASKED:1,DD_IN_PROGRESS:2},STATE_NAME:{IDLE:"IDLE",DDINPROGRESS:"DDINPROGRESS"}}},COMSCORE.SiteRecruit.Utils=function(){var r=COMSCORE.SiteRecruit;return{location:document.location.toString(),referrer:document.referrer.toString(),loadScript:function(e,t){t&&!r.allowScriptCaching&&(e=r.Utils.appendQueryParams(e,(new Date).getTime()));var i=document.createElement("script");i.src=e,document.body.appendChild(i)},getDevice:function(){var e=new RegExp("iphone|ipad|ipod|android|opera mini|blackberry|windows (phone|ce)|iemobile|htc|nokia|bb10|silk","i"),t=navigator.userAgent,i=new RegExp("phone|sm-(n|g)|pixel.+xl|ph-1|oneplus|lg-|nexus 6|lm-q","i"),r=self.screen.availWidth>self.screen.availHeight?self.screen.availWidth:self.screen.availHeight,n={};return e.test(t)?(n.type=2,770<=r&&!i.test(t)&&(n.type=3)):n.type=1,n},fireBeacon:function(e){setTimeout(function(){-1==e.indexOf("?")?e+=(/\?/.test(e)?"&":"?")+(new Date).getTime():e+="&"+(new Date).getTime(),(new Image).src=e},1)},appendQueryParams:function(e,t){return e?(e=e.replace("?","")+"?",t&&(e+=t.toString().replace("?","")),e):t},getRandom:function(e){function t(e,t,i,r,n){var a=Math.floor(e/i);return a=t*(e-a*i)-a*r,Math.round(a<0?a+n:a)}for(var i=2147483563,r=40014,n=53668,a=12211,o=2147483647&Math.round((new Date).getTime()%1e5),s=o,c=[32],u=0;u<19;u++)s=t(s,r,n,a,i);for(u=0;u<32;u++)s=t(s,r,n,a,i),c[31-u]=s;s=t(s,r,n,a,i),o=t(o,40692,52774,3791,2147483399);var d=Math.round((c[Math.floor(c[0]/67108862)]+o)%i),l=Math.floor(d/(i/(1e9+1)))/1e9;return void 0===e?l:Math.floor(l*(e+1))},getExecutingPath:function(e){for(var t=document.getElementsByTagName("script"),i=t.length-1;0<=i;i--){var r=t[i].src;if(-1!=(this.scriptUrl=r).indexOf("/"+e))return r.replace(/(.*)(\/.*)$/,"$1/")}},JSONDeserialize:function(e){try{if(""===e&&(e='""'),4<e.length){if(window.JSON&&window.JSON.parse)return-1==e.indexOf('"undefined"')?window.JSON.parse(e.replace("undefined",'"undefined"')):window.JSON.parse(e);var t=e.substring(1,e.indexOf(","))+e.substring(e.indexOf("}")+1,e.length-1),i=e.slice(e.indexOf("name"),e.indexOf("}")).replace(/"/gi,""),r=e.substring(e.indexOf("[")+1,e.indexOf("]")).replace(/"/gi,""),n=t.substring(0,t.indexOf("surveys")-1).replace(/"/gi,"")+t.substring(t.indexOf("],")+2,t.length).replace(/"/gi,""),a=i.split(","),o=r.split(","),s=n.split(","),c={};c.sv=s[0].substring(s[0].indexOf(":")+1),c.state={},c.state.name=a[0].substring(a[0].indexOf(":")+1),c.state.url=a[1].substring(a[1].indexOf(":")+1),c.state.timestamp=parseInt(a[2].substring(a[2].indexOf(":")+1)),c.lastinvited=parseInt(s[1].substring(s[1].indexOf(":")+1)),c.userid=s[2].substring(s[2].indexOf(":")+1),c.vendorid=parseInt(s[3].substring(s[3].indexOf(":")+1)),c.surveys=[];for(var u=0;u<o.length;u++)c.surveys.push(o[u]);return c.graceperiod=parseInt(s[4].substring(s[4].indexOf(":")+1)),c.trackertimestamp=parseInt(s[5].substring(s[5].indexOf(":")+1)),c}return null}catch(e){return null}},JSONSerialize:function(e){try{var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var i,r,n=[],a=e&&e.constructor==Array;for(i in e)"function"!=(t=typeof(r=e[i]))&&("string"==t?r='"'+r+'"':"object"==t&&null!==r&&(r=this.JSONSerialize(r)),n.push((a?"":'"'+i+'":')+String(r)));return(a?"[":"{")+String(n)+(a?"]":"}")}catch(e){return""}}}}(),COMSCORE.SiteRecruit.Utils.UserPersistence={maxNumberOfPids:6,CONSTANTS:{STATE_NAME:{IDLE:"IDLE",DDINPROGRESS:"DDINPROGRESS"}},getCookieName:function(){var e;return COMSCORE.SiteRecruit.Broker&&COMSCORE.SiteRecruit.Broker.config&&(e=COMSCORE.SiteRecruit.Broker.config.cookie).name?e.name:""},getDefaultCookieOptions:function(){return{path:"/",domain:""}},getVendorId:function(){return 1},createCookie:function(e,t,i){if(t=escape(t),i.duration&&i.duration<0)(r=new Date).setTime(r.getTime()+24*i.duration*60*60*1e3),t+="; expires="+r.toGMTString();else if("s"==i.duration)/msie|rv\:11|edge/i.test(navigator.userAgent)||(t+="; expires=");else{var r;(r=new Date).setTime(r.getTime()+31536e7),t+="; expires="+r.toGMTString()}return i.path&&(t+="; path="+i.path),i.domain&&(t+="; domain="+i.domain),i.secure&&(t+="; secure"),i.graceperiod&&(t+="; graceperiod="+i.graceperiod),t+="; SameSite=Strict",document.cookie=e+"="+t,!0},getCookieValue:function(e){var t=document.cookie.match("(?:^|;)\\s*"+e+"=([^;]*)");return!!t&&unescape(t[1])},createUserObj:function(e){var t=new Date,i=e.pid,r=e.url,n=this.CONSTANTS.STATE_NAME.IDLE;e.statename&&(n=e.statename);var a=t.getTime();e.timestamp&&(a=e.timestamp);var o=this.getCookieName();e.cookiename&&(o=e.cookiename),e.cookieoptions||(e.cookieoptions=this.getDefaultCookieOptions());var s={};s.sv=COMSCORE.SiteRecruit.sv,s.state={},s.state.name=n,s.state.url=r,s.state.timestamp=a,s.lastinvited=a,s.userid=t.getTime().toString()+Math.floor(1e16*Math.random()).toString(),s.vendorid=this.getVendorId(),s.surveys=[],s.surveys.push(i),s.graceperiod=5;var c=COMSCORE.SiteRecruit.Utils.JSONSerialize(s);return this.createCookie(o,c,e.cookieoptions),s},setUserObj:function(e){var t,r,n,a,o,s,c,u,d=this.getUserObj(e);if(d||(d=this.createUserObj(e)),u=new Date,a=0,o=this.getCookieName(),s=5,c=0,n=this.CONSTANTS.STATE_NAME.IDLE,t=e.pid,e.url?r=e.url:d.state.url&&(r=d.state.url),e.statename?n=e.statename:d.state&&d.state.name&&(n=d.state.name),e.timestamp?a=e.timestamp:d.state&&d.state.timestamp&&(a=d.state.timestamp),e.cookiename&&(o=e.cookiename),e.cookieoptions||(e.cookieoptions=this.getDefaultCookieOptions()),e.graceperiod?s=e.graceperiod:d.graceperiod&&(s=d.graceperiod),e.trackertimestamp?c=e.trackertimestamp:d.trackertimestamp&&(c=d.trackertimestamp),d.lastinvited=u.getTime(),t){var l=!1;for(i=0;i<d.surveys.length;i++)d.surveys[i]&&d.surveys[i].toLowerCase()==t.toLowerCase()&&(l=!0);for(!1===l&&(d.surveys.length&&(d.surveys.length<this.maxNumberOfPids||d.surveys.splice(0,1)),d.surveys.push(t)),i=0;i<d.surveys.length;i++)null===d.surveys[i]&&d.surveys.splice(i,1)}n&&(d.state.name=n,d.state.url=r,d.state.timestamp=a,d.graceperiod=s,d.trackertimestamp=c);var g=COMSCORE.SiteRecruit.Utils.JSONSerialize(d);return this.createCookie(o,g,e.cookieoptions),d},getUserObj:function(e){var t=this.getCookieName();e.cookiename&&(t=e.cookiename);var i=this.getCookieValue(t);if(i&&""!==i){var r=COMSCORE.SiteRecruit.Utils.JSONDeserialize(i);if(r)return r}return null}},COMSCORE.SiteRecruit.DDKeepAlive=function(){var t,o=COMSCORE.SiteRecruit,s=o.Utils;return{start:function(){var e=this;t=setInterval(function(){o.Broker.isDDInProgress()&&e.isTrackerPageOpen()?e.setDDTrackerCookie():e.isTrackerPageOpen()?e.stop():e.handleClosedTrackerPage()},1e3)},stop:function(){clearInterval(t)},isTrackerPageOpen:function(){var e={};e.cookiename=COMSCORE.SiteRecruit.Broker.config.cookie.name;var t,i=s.UserPersistence.getUserObj(e),r=(new Date).getTime(),n=!0;if(i&&i.state&&i.state.name==o.CONSTANTS.STATE_NAME.DDINPROGRESS&&i.state.timestamp&&i.trackertimestamp){var a=r-i.trackertimestamp;if(COMSCORE.SiteRecruit.Builder&&COMSCORE.SiteRecruit.Builder.invitation&&COMSCORE.SiteRecruit.Builder.invitation.config?t=COMSCORE.SiteRecruit.Builder.invitation.config.trackerGracePeriod:i.gracePeriod&&(t=i.gracePeriod),t)a<2*(t=parseInt(t))*1e3||(n=!1)}return n},handleClosedTrackerPage:function(){var e={},t=o.Broker.config.cookie;e.cookiename=t.name,e.statename=o.CONSTANTS.STATE_NAME.IDLE,e.cookieoptions={path:t.path,domain:t.domain},e.url=escape(s.location),e.timestamp=(new Date).getTime(),s.UserPersistence.setUserObj(e),this.stop()},setDDTrackerCookie:function(){var e=o.Broker.config.cookie,t={};t.cookiename=e.name;var i=s.UserPersistence.getUserObj(t);t.cookiename=e.name,!(t.cookieoptions={path:e.path,domain:e.domain})===document.hidden||void 0===document.hidden?t.url=escape(s.location):t.url=s.UserPersistence.getUserObj(e.name).state.url,t.statename=o.CONSTANTS.STATE_NAME.DDINPROGRESS,t.timestamp=(new Date).getTime(),COMSCORE.SiteRecruit.Builder&&COMSCORE.SiteRecruit.Builder.invitation&&COMSCORE.SiteRecruit.Builder.invitation.config?(t.pid=COMSCORE.SiteRecruit.Builder.invitation.config.projectId,t.graceperiod=COMSCORE.SiteRecruit.Builder.invitation.config.trackerGracePeriod):i&&i.gracePeriod&&(t.graceperiod=i.graceperiod),s.UserPersistence.setUserObj(t)}}}(),COMSCORE.SiteRecruit.PagemapFinder=function(){var d,a=COMSCORE.SiteRecruit.Utils;return{getTotalFreq:function(){return d},find:function(e){var t=window.location.toString();/cs\_tstMode\=(.+)/i.test(t)&&/([^\#+]*)/.test(t)&&(t=RegExp.$1);for(var i=e,r=[],n=!1,a=d=0;i&&a<i.length;a++){var o=!1,s=i[a];if(s){var c=new RegExp(s.m,"i");if(-1!=t.search(c)){var u=i[a].prereqs;o=!0,u&&(this.isMatchContent(u.content)||(o=!1),this.isMatchCookie(u.cookie)||(o=!1),this.isMatchLanguage(u.language)||(o=!1))}if(o){if(s.halt){n=!0;break}r.push(s),d=s.f}}}return!0===n?(d=0,r=null):this.choosePriority(r)},choosePriority:function(e){for(var t=null,i=0;i<e.length;i++)null===t?(t=e[i],d=e[i].f):t.p<e[i].p&&(t=e[i],d=e[i].f);return t},isMatchContent:function(e){for(var t=!0,i=0;t&&i<e.length;){var r=!1,n=!1,a=e[i];if(a.element)for(var o=document.getElementsByTagName(a.element),s=!0,c=0;c<o.length;c++){var u=new RegExp(a.elementValue,"i");if(u?u.test(o[c].innerHTML)&&(s&&(s=!1),r=!0):r=!0,a.attrib&&a.attrib.length){var d=o[c].attributes.getNamedItem(a.attrib),l=new RegExp(a.attribValue);d&&(a.attribValue&&a.attribValue.length?l.test(d.value)&&(n=!0):n=!0)}else n=!0}r&&n||(t=!1),i++}return t},isMatchCookie:function(e){for(var t=!0,i=0;t&&i<e.length;){var r=e[i],n=a.UserPersistence.getCookieValue(r.name);if(!n||null===n)return!1;t=new RegExp(r.value,"i").test(n),i++}return t},isMatchLanguage:function(e){var t=navigator.language||navigator.userLanguage;return t=t.toLowerCase(),!e||!!new RegExp(e).test(t)}}}(),COMSCORE.SiteRecruit.Broker=function(){var u=COMSCORE.SiteRecruit,d=u.Utils;return{init:function(){u.device=d.getDevice(),u.executingPath=d.getExecutingPath("broker.js"),/cs\_tstMode/i.test(window.location)&&d.loadScript("https://www.microsoft.com/library/svy/"+u.testUrl,!0),d.loadScript(u.executingPath+u.configUrl,!0)},start:function(){this.init()},run:function(){if(this.config.Events.beforeRecruit(),this.config.mobile){var e=new RegExp(this.config.mobile.match,"i");if(!0===this.config.mobile.halt&&e.test(navigator.userAgent))return}if(u.sv===this.config.sv){var t,i,r=this.config.testMode;if(t=!1!==d.UserPersistence.getCookieValue("tstMode"),i=r||t,this.isDDInProgress()&&this.processDDInProgress(),!r||this.isDDInProgress()){var n={};n.cookiename=this.config.cookie.name;var a=d.UserPersistence.getUserObj(n),o=new Date,s=this.config.cookie.duration,c=o.getTime()-24*s*60*60*1e3;if(a&&a.lastinvited>c)return}if(this.findPageMapping()&&(!COMSCORE.SiteRecruit._halt||!0!==COMSCORE.SiteRecruit._halt))if(i)this.pagemap&&this.loadBuilder();else d.getRandom()<=u.PagemapFinder.getTotalFreq()&&this.pagemap&&this.loadBuilder()}},isDDInProgress:function(){var e=!1,t={};t.cookiename=COMSCORE.SiteRecruit.Broker.config.cookie.name;var i=d.UserPersistence.getUserObj(t);return i&&i.state.name==u.CONSTANTS.STATE_NAME.DDINPROGRESS&&(e=!0),e},processDDInProgress:function(){u.DDKeepAlive.start()},findPageMapping:function(){return this.pagemap=u.PagemapFinder.find(this.config.mapping),this.pagemap},loadBuilder:function(){var e=u.executingPath+u.builderUrl;d.loadScript(e)}}}(),COMSCORE.isDDInProgress=COMSCORE.SiteRecruit.Broker.isDDInProgress,COMSCORE.SiteRecruit.OnReady=function(){var o=COMSCORE.SiteRecruit;return{onload:function(){o.OnReady.done||(o.OnReady.done=!0,o.Broker.start(),o.OnReady.timer&&clearInterval(o.OnReady.timer),document.addEventListener&&document.removeEventListener("DOMContentLoaded",o.OnReady.onload,!1))},listen:function(){var e=document.domain.split(".");e="."+e[e.length-2]+"."+e[e.length-1];var t="msresearch",i=COMSCORE.SiteRecruit.Utils.UserPersistence.getCookieValue(t);/DDINPROGRESS/i.test(i)&&(COMSCORE.SiteRecruit.Broker.config={cookie:{name:t,path:"/",domain:e,duration:90,rapidDuration:0,expireDate:""}},COMSCORE.SiteRecruit.Broker.processDDInProgress());var r=document.domain.split("."),n="";r=r[r.length-2]+"."+r[r.length-1];var a=new RegExp(r,"i");if(""!==document.referrer&&(n=document.referrer),""===n||void 0===n||a.test(n)?o.Broker.delayConfig=!1:o.Broker.delayConfig=!0,document.addEventListener&&(/loading|uninitialized/i.test(document.readyState)?document.addEventListener("DOMContentLoaded",o.OnReady.onload,!1):o.OnReady.onload()),window.ActiveXObject)COMSCORE.SiteRecruit.OnReady.waitForLoad=setInterval(function(){try{document.documentElement.doScroll("left")}catch(e){return}COMSCORE.SiteRecruit.OnReady.waitForLoad=clearInterval(COMSCORE.SiteRecruit.OnReady.waitForLoad),COMSCORE.SiteRecruit.OnReady.onload()},1e3);else if(window.addEventListener)window.addEventListener("load",o.OnReady.onload,!1);else if(window.attachEvent)return window.attachEvent("onload",o.OnReady.onload)},f:[],done:!1,timer:null}}(),COMSCORE.SiteRecruit.OnReady.listen());